      real*8 function qtau(tau)
      implicit none
      real*8 tau
      integer i
      real*8 tab_qtau(500)
      data tab_qtau / 0.009723436d0, 0.019031709d0, 0.028002313d0, 
     $     0.036676058d0, 0.04508115d0, 0.053239117d0, 0.06116732d0, 
     $     0.068880269d0, 0.076390394d0, 0.083708542d0, 
     $     0.090844314d0, 0.097806307d0, 0.104602288d0, 
     $     0.111239331d0, 0.117723916d0, 0.124062019d0, 
     $     0.130259171d0, 0.136320516d0, 0.142250856d0, 
     $     0.148054688d0, 0.153736234d0, 0.159299471d0, 
     $     0.164748154d0, 0.170085833d0, 0.175315874d0, 
     $     0.180441474d0, 0.185465673d0, 0.190391368d0, 
     $     0.195221321d0, 0.199958173d0, 0.204604449d0, 
     $     0.209162566d0, 0.213634841d0, 0.218023499d0, 
     $     0.222330675d0, 0.226558424d0, 0.23070872d0, 0.234783466d0, 
     $     0.238784496d0, 0.242713577d0, 0.246572415d0, 
     $     0.250362657d0, 0.254085895d0, 0.257743667d0, 
     $     0.261337463d0, 0.264868721d0, 0.268338837d0, 
     $     0.271749162d0, 0.275101005d0, 0.278395636d0, 
     $     0.281634286d0, 0.284818152d0, 0.287948393d0, 
     $     0.291026135d0, 0.294052475d0, 0.297028476d0, 
     $     0.299955173d0, 0.302833572d0, 0.30566465d0, 0.308449362d0, 
     $     0.311188634d0, 0.313883369d0, 0.316534445d0, 0.31914272d0, 
     $     0.321709028d0, 0.324234182d0, 0.326718977d0, 
     $     0.329164184d0, 0.331570559d0, 0.333938838d0, 
     $     0.336269738d0, 0.338563961d0, 0.340822191d0, 
     $     0.343045095d0, 0.345233327d0, 0.347387524d0, 
     $     0.349508308d0, 0.351596288d0, 0.353652057d0, 
     $     0.355676198d0, 0.357669279d0, 0.359631854d0, 
     $     0.361564467d0, 0.363467649d0, 0.365341919d0, 
     $     0.367187787d0, 0.36900575d0, 0.370796294d0, 0.372559896d0, 
     $     0.374297022d0, 0.376008128d0, 0.377693663d0, 
     $     0.379354063d0, 0.380989758d0, 0.382601167d0, 
     $     0.384188701d0, 0.385752764d0, 0.38729375d0, 0.388812047d0, 
     $     0.390308033d0, 0.39178208d0, 0.393234552d0, 0.394665806d0, 
     $     0.396076193d0, 0.397466055d0, 0.39883573d0, 0.400185547d0, 
     $     0.40151583d0, 0.402826896d0, 0.404119057d0, 0.405392618d0, 
     $     0.40664788d0, 0.407885136d0, 0.409104675d0, 0.41030678d0, 
     $     0.411491729d0, 0.412659795d0, 0.413811245d0, 
     $     0.414946343d0, 0.416065347d0, 0.417168509d0, 
     $     0.418256078d0, 0.4193283d0, 0.420385412d0, 0.421427652d0, 
     $     0.42245525d0, 0.423468434d0, 0.424467426d0, 0.425452446d0, 
     $     0.42642371d0, 0.427381427d0, 0.428325807d0, 0.429257054d0, 
     $     0.430175368d0, 0.431080946d0, 0.431973982d0, 
     $     0.432854667d0, 0.433723187d0, 0.434579727d0, 
     $     0.435424466d0, 0.436257584d0, 0.437079254d0, 
     $     0.437889648d0, 0.438688935d0, 0.439477281d0, 
     $     0.440254849d0, 0.4410218d0, 0.44177829d0, 0.442524476d0, 
     $     0.44326051d0, 0.443986541d0, 0.444702718d0, 0.445409186d0, 
     $     0.446106086d0, 0.44679356d0, 0.447471746d0, 0.448140779d0, 
     $     0.448800793d0, 0.44945192d0, 0.450094288d0, 0.450728026d0, 
     $     0.451353257d0, 0.451970106d0, 0.452578693d0, 
     $     0.453179138d0, 0.453771559d0, 0.454356069d0, 
     $     0.454932784d0, 0.455501815d0, 0.456063272d0, 
     $     0.456617264d0, 0.457163896d0, 0.457703274d0, 
     $     0.458235502d0, 0.45876068d0, 0.45927891d0, 0.459790289d0, 
     $     0.460294915d0, 0.460792882d0, 0.461284286d0, 
     $     0.461769218d0, 0.46224777d0, 0.462720031d0, 0.46318609d0, 
     $     0.463646034d0, 0.464099948d0, 0.464547917d0, 
     $     0.464990023d0, 0.46542635d0, 0.465856976d0, 0.466281982d0, 
     $     0.466701445d0, 0.467115443d0, 0.467524052d0, 
     $     0.467927345d0, 0.468325397d0, 0.468718279d0, 
     $     0.469106064d0, 0.469488821d0, 0.46986662d0, 0.470239529d0, 
     $     0.470607615d0, 0.470970944d0, 0.471329581d0, 
     $     0.471683591d0, 0.472033037d0, 0.472377981d0, 
     $     0.472718485d0, 0.473054609d0, 0.473386413d0, 
     $     0.473713955d0, 0.474037293d0, 0.474356485d0, 
     $     0.474671586d0, 0.474982653d0, 0.475289739d0, 
     $     0.475592898d0, 0.475892184d0, 0.476187649d0, 
     $     0.476479343d0, 0.476767319d0, 0.477051625d0, 
     $     0.477332311d0, 0.477609426d0, 0.477883018d0, 
     $     0.478153133d0, 0.478419819d0, 0.47868312d0, 0.478943083d0, 
     $     0.479199752d0, 0.47945317d0, 0.479703382d0, 0.479950429d0, 
     $     0.480194353d0, 0.480435197d0, 0.480673002d0, 
     $     0.480907806d0, 0.48113965d0, 0.481368574d0, 0.481594616d0, 
     $     0.481817813d0, 0.482038204d0, 0.482255826d0, 
     $     0.482470714d0, 0.482682906d0, 0.482892435d0, 
     $     0.483099338d0, 0.483303649d0, 0.483505402d0, 
     $     0.483704631d0, 0.483901367d0, 0.484095645d0, 
     $     0.484287496d0, 0.484476952d0, 0.484664044d0, 
     $     0.484848804d0, 0.48503126d0, 0.485211444d0, 0.485389386d0, 
     $     0.485565113d0, 0.485738655d0, 0.485910041d0, 
     $     0.486079298d0, 0.486246453d0, 0.486411535d0, 0.48657457d0, 
     $     0.486735584d0, 0.486894604d0, 0.487051655d0, 
     $     0.487206763d0, 0.487359953d0, 0.487511249d0, 
     $     0.487660676d0, 0.487808258d0, 0.487954018d0, 
     $     0.488097981d0, 0.488240169d0, 0.488380605d0, 
     $     0.488519311d0, 0.48865631d0, 0.488791623d0, 0.488925273d0, 
     $     0.489057279d0, 0.489187664d0, 0.489316448d0, 
     $     0.489443651d0, 0.489569294d0, 0.489693397d0, 
     $     0.489815978d0, 0.489937058d0, 0.490056656d0, 0.49017479d0, 
     $     0.490291479d0, 0.490406741d0, 0.490520595d0, 
     $     0.490633058d0, 0.490744148d0, 0.490853883d0, 
     $     0.490962279d0, 0.491069353d0, 0.491175123d0, 
     $     0.491279604d0, 0.491382813d0, 0.491484766d0, 
     $     0.491585479d0, 0.491684968d0, 0.491783247d0, 
     $     0.491880332d0, 0.491976238d0, 0.49207098d0, 0.492164573d0, 
     $     0.492257031d0, 0.492348368d0, 0.492438598d0, 
     $     0.492527735d0, 0.492615794d0, 0.492702786d0, 
     $     0.492788727d0, 0.492873628d0, 0.492957503d0, 
     $     0.493040365d0, 0.493122226d0, 0.493203099d0, 
     $     0.493282996d0, 0.493361929d0, 0.493439911d0, 
     $     0.493516953d0, 0.493593067d0, 0.493668264d0, 
     $     0.493742556d0, 0.493815954d0, 0.493888469d0, 
     $     0.493960113d0, 0.494030895d0, 0.494100828d0, 0.49416992d0, 
     $     0.494238183d0, 0.494305627d0, 0.494372261d0, 
     $     0.494438097d0, 0.494503144d0, 0.494567411d0, 
     $     0.494630909d0, 0.494693646d0, 0.494755633d0, 
     $     0.494816878d0, 0.49487739d0, 0.494937179d0, 0.494996254d0, 
     $     0.495054623d0, 0.495112295d0, 0.495169278d0, 
     $     0.495225581d0, 0.495281213d0, 0.495336182d0, 
     $     0.495390495d0, 0.495444161d0, 0.495497187d0, 
     $     0.495549583d0, 0.495601354d0, 0.49565251d0, 0.495703057d0, 
     $     0.495753003d0, 0.495802355d0, 0.495851121d0, 
     $     0.495899308d0, 0.495946922d0, 0.495993971d0, 
     $     0.496040462d0, 0.496086401d0, 0.496131795d0, 
     $     0.496176652d0, 0.496220976d0, 0.496264776d0, 
     $     0.496308057d0, 0.496350825d0, 0.496393088d0, 0.49643485d0, 
     $     0.496476118d0, 0.496516899d0, 0.496557197d0, 
     $     0.496597019d0, 0.496636371d0, 0.496675258d0, 
     $     0.496713686d0, 0.49675166d0, 0.496789187d0, 0.49682627d0, 
     $     0.496862917d0, 0.496899132d0, 0.49693492d0, 0.496970286d0, 
     $     0.497005236d0, 0.497039774d0, 0.497073906d0, 
     $     0.497107637d0, 0.497140971d0, 0.497173912d0, 
     $     0.497206467d0, 0.497238639d0, 0.497270433d0, 
     $     0.497301854d0, 0.497332906d0, 0.497363593d0, 0.49739392d0, 
     $     0.497423892d0, 0.497453512d0, 0.497482785d0, 
     $     0.497511714d0, 0.497540305d0, 0.497568561d0, 
     $     0.497596486d0, 0.497624084d0, 0.497651359d0, 
     $     0.497678315d0, 0.497704956d0, 0.497731285d0, 
     $     0.497757306d0, 0.497783024d0, 0.49780844d0, 0.49783356d0, 
     $     0.497858387d0, 0.497882924d0, 0.497907174d0, 
     $     0.497931142d0, 0.497954829d0, 0.497978241d0, 0.49800138d0, 
     $     0.498024249d0, 0.498046851d0, 0.498069191d0, 0.49809127d0, 
     $     0.498113092d0, 0.49813466d0, 0.498155977d0, 0.498177046d0, 
     $     0.49819787d0, 0.498218452d0, 0.498238794d0, 0.498258901d0, 
     $     0.498278773d0, 0.498298415d0, 0.498317829d0, 
     $     0.498337017d0, 0.498355983d0, 0.498374728d0, 
     $     0.498393256d0, 0.498411569d0, 0.49842967d0, 0.498447561d0, 
     $     0.498465245d0, 0.498482724d0, 0.4985d0, 0.498517076d0, 
     $     0.498533955d0, 0.498550638d0, 0.498567128d0, 
     $     0.498583427d0, 0.498599538d0, 0.498615463d0, 
     $     0.498631203d0, 0.498646762d0, 0.49866214d0, 0.498677341d0, 
     $     0.498692367d0, 0.498707219d0, 0.498721899d0, 0.49873641d0, 
     $     0.498750754d0, 0.498764932d0, 0.498778947d0, 0.4987928d0, 
     $     0.498806493d0, 0.498820028d0, 0.498833408d0, 
     $     0.498846633d0, 0.498859706d0, 0.498872629d0, 
     $     0.498885403d0, 0.498898029d0, 0.498910511d0, 
     $     0.498922848d0, 0.498935044d0, 0.4989471d0, 0.498959017d0, 
     $     0.498970797d0, 0.498982442d0, 0.498993953d0, 
     $     0.499005331d0, 0.499016579d0, 0.499027698d0, 
     $     0.499038689d0, 0.499049554d0, 0.499060295d0, 
     $     0.499070912d0, 0.499081407d0, 0.499091782d0, 
     $     0.499102038d0, 0.499112177d0, 0.499122199d0 /
      
      if ( tau.gt.5 ) then
         qtau=0.5d0
         return
      end if

      if  ( tau.le.0.01 ) then
         qtau=tau
         return
      end if

      i=floor(tau*100.d0)
      if ( tau.ge.1 ) then
         qtau=tab_qtau(i)
         return
      end if

!     the remaining range is for 0.01<tau<1 where values are getting close to be proportional of tau  
      qtau = tau * tab_qtau(i)/(i/100.)
      
      return
      end function

